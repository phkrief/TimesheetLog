<!-- 
#-------------------------------------------------------------------------------
# Copyright (C) 2017 EFE.
# All rights reserved. This program and the accompanying materials
# are made available under the terms of the Eclipse Public License v1.0
# which accompanies this distribution, and is available at
# http://www.eclipse.org/legal/epl-v10.html
# 
# Contributors:
#     EFE - initial API and implementation
#-------------------------------------------------------------------------------
 -->
<script>
function run() {
   // Gather Calendars
   var elements = document.getElementsByName("calendars");
   var selectedCal =[];
   for (var i = 0; i < elements.length; i++) {
      var checkbox = elements[i];

      if (checkbox.checked) selectedCal.push(checkbox.id);
   }

   var startDate = document.getElementById("startDate").value;
   var endDate = document.getElementById("endDate").value;

   google.script.run.extractAll(selectedCal, startDate, endDate);
}
</script>
